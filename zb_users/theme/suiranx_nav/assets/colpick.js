(function(f){var W=function(){var W='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',b={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:true,flat:false,layout:"full",submit:1,submitText:"OK",height:156},A=function(W,b){var a=e(W);f(b).data("colpick").fields.eq(1).val(a.r).end().eq(2).val(a.g).end().eq(3).val(a.b).end()},h=function(W,b){f(b).data("colpick").fields.eq(4).val(Math.round(W.h)).end().eq(5).val(Math.round(W.s)).end().eq(6).val(Math.round(W.b)).end()},c=function(W,b){f(b).data("colpick").fields.eq(0).val(eV(W))},bZ=function(W,b){f(b).data("colpick").selector.css("backgroundColor","#"+eV({h:W.h,s:100,b:100}));f(b).data("colpick").selectorIndic.css({left:parseInt(f(b).data("colpick").height*W.s/100,10),top:parseInt(f(b).data("colpick").height*(100-W.b)/100,10)})},cF=function(W,b){f(b).data("colpick").hue.css("top",parseInt(f(b).data("colpick").height-f(b).data("colpick").height*W.h/360,10))},eh=function(W,b){f(b).data("colpick").currentColor.css("backgroundColor","#"+eV(W))},fP=function(W,b){f(b).data("colpick").newColor.css("backgroundColor","#"+eV(W))},fL=function(W){var b=f(this).parent().parent(),eh;if(this.parentNode.className.indexOf("_hex")>0){b.data("colpick").color=eh=a(edbZ(this.value));A(eh,b.get(0));h(eh,b.get(0))}else if(this.parentNode.className.indexOf("_hsb")>0){b.data("colpick").color=eh=H({h:parseInt(b.data("colpick").fields.eq(4).val(),10),s:parseInt(b.data("colpick").fields.eq(5).val(),10),b:parseInt(b.data("colpick").fields.eq(6).val(),10)});A(eh,b.get(0));c(eh,b.get(0))}else{b.data("colpick").color=eh=aQ(gc({r:parseInt(b.data("colpick").fields.eq(1).val(),10),g:parseInt(b.data("colpick").fields.eq(2).val(),10),b:parseInt(b.data("colpick").fields.eq(3).val(),10)}));c(eh,b.get(0));h(eh,b.get(0))}bZ(eh,b.get(0));cF(eh,b.get(0));fP(eh,b.get(0));b.data("colpick").onChange.apply(b.parent(),[eh,eV(eh),e(eh),b.data("colpick").el,0])},bU=function(W){f(this).parent().removeClass("colpick_focus")},bi=function(){f(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus");f(this).parent().addClass("colpick_focus")},bF=function(W){W.preventDefault?W.preventDefault():W.returnValue=false;var b=f(this).parent().find("input").focus();var a={el:f(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:W.pageY,field:b,val:parseInt(b.val(),10),preview:f(this).parent().parent().data("colpick").livePreview};f(document).mouseup(a,aC);f(document).mousemove(a,ed)},ed=function(f){f.data.field.val(Math.max(0,Math.min(f.data.max,parseInt(f.data.val-f.pageY+f.data.y,10))));if(f.data.preview){fL.apply(f.data.field.get(0),[true])}return false},aC=function(W){fL.apply(W.data.field.get(0),[true]);W.data.el.removeClass("colpick_slider").find("input").focus();f(document).off("mouseup",aC);f(document).off("mousemove",ed);return false},eG=function(W){W.preventDefault?W.preventDefault():W.returnValue=false;var b={cal:f(this).parent(),y:f(this).offset().top};f(document).on("mouseup touchend",b,fV);f(document).on("mousemove touchmove",b,fA);var a=W.type=="touchstart"?W.originalEvent.changedTouches[0].pageY:W.pageY;fL.apply(b.cal.data("colpick").fields.eq(4).val(parseInt(360*(b.cal.data("colpick").height-(a-b.y))/b.cal.data("colpick").height,10)).get(0),[b.cal.data("colpick").livePreview]);return false},fA=function(f){var W=f.type=="touchmove"?f.originalEvent.changedTouches[0].pageY:f.pageY;fL.apply(f.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(f.data.cal.data("colpick").height-Math.max(0,Math.min(f.data.cal.data("colpick").height,W-f.data.y)))/f.data.cal.data("colpick").height,10)).get(0),[f.data.preview]);return false},fV=function(W){A(W.data.cal.data("colpick").color,W.data.cal.get(0));c(W.data.cal.data("colpick").color,W.data.cal.get(0));f(document).off("mouseup touchend",fV);f(document).off("mousemove touchmove",fA);return false},g=function(W){W.preventDefault?W.preventDefault():W.returnValue=false;var b={cal:f(this).parent(),pos:f(this).offset()};b.preview=b.cal.data("colpick").livePreview;f(document).on("mouseup touchend",b,cS);f(document).on("mousemove touchmove",b,L);var a,aQ;if(W.type=="touchstart"){pageX=W.originalEvent.changedTouches[0].pageX,aQ=W.originalEvent.changedTouches[0].pageY}else{pageX=W.pageX;aQ=W.pageY}fL.apply(b.cal.data("colpick").fields.eq(6).val(parseInt(100*(b.cal.data("colpick").height-(aQ-b.pos.top))/b.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-b.pos.left)/b.cal.data("colpick").height,10)).get(0),[b.preview]);return false},L=function(f){var W,b;if(f.type=="touchmove"){pageX=f.originalEvent.changedTouches[0].pageX,b=f.originalEvent.changedTouches[0].pageY}else{pageX=f.pageX;b=f.pageY}fL.apply(f.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(f.data.cal.data("colpick").height-Math.max(0,Math.min(f.data.cal.data("colpick").height,b-f.data.pos.top)))/f.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(f.data.cal.data("colpick").height,pageX-f.data.pos.left))/f.data.cal.data("colpick").height,10)).get(0),[f.data.preview]);return false},cS=function(W){A(W.data.cal.data("colpick").color,W.data.cal.get(0));c(W.data.cal.data("colpick").color,W.data.cal.get(0));f(document).off("mouseup touchend",cS);f(document).off("mousemove touchmove",L);return false},ej=function(W){var b=f(this).parent();var a=b.data("colpick").color;b.data("colpick").origColor=a;eh(a,b.get(0));b.data("colpick").onSubmit(a,eV(a),e(a),b.data("colpick").el)},cK=function(W){W.stopPropagation();var b=f("#"+f(this).data("colpickId"));b.data("colpick").onBeforeShow.apply(this,[b.get(0)]);var a=f(this).offset();var aQ=a.top+this.offsetHeight;var e=a.left;var A=edb();var eV=b.width();if(e+eV>A.l+A.w){e-=eV}b.css({left:e+"px",top:aQ+"px"});if(b.data("colpick").onShow.apply(this,[b.get(0)])!=false){b.show()}f("html").mousedown({cal:b},cg);b.mousedown(function(f){f.stopPropagation()})},cg=function(W){if(W.data.cal.data("colpick").onHide.apply(this,[W.data.cal.get(0)])!=false){W.data.cal.hide()}f("html").off("mousedown",cg)},edb=function(){var f=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(f?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(f?document.documentElement.clientWidth:document.body.clientWidth)}},H=function(f){return{h:Math.min(360,Math.max(0,f.h)),s:Math.min(100,Math.max(0,f.s)),b:Math.min(100,Math.max(0,f.b))}},gc=function(f){return{r:Math.min(255,Math.max(0,f.r)),g:Math.min(255,Math.max(0,f.g)),b:Math.min(255,Math.max(0,f.b))}},edbZ=function(f){var W=6-f.length;if(W>0){var b=[];for(var a=0;a<W;a++){b.push("0")}b.push(f);f=b.join("")}return f},d=function(){var W=f(this).parent();var b=W.data("colpick").origColor;W.data("colpick").color=b;A(b,W.get(0));c(b,W.get(0));h(b,W.get(0));bZ(b,W.get(0));cF(b,W.get(0));fP(b,W.get(0))};return{init:function(e){e=f.extend({},b,e||{});if(typeof e.color=="string"){e.color=a(e.color)}else if(e.color.r!=undefined&&e.color.g!=undefined&&e.color.b!=undefined){e.color=aQ(e.color)}else if(e.color.h!=undefined&&e.color.s!=undefined&&e.color.b!=undefined){e.color=H(e.color)}else{return this}return this.each(function(){if(!f(this).data("colpickId")){var b=f.extend({},e);b.origColor=e.color;var a="collorpicker_"+parseInt(Math.random()*1e3);f(this).data("colpickId",a);var aQ=f(W).attr("id",a);aQ.addClass("colpick_"+b.layout+(b.submit?"":" colpick_"+b.layout+"_ns"));if(b.colorScheme!="light"){aQ.addClass("colpick_"+b.colorScheme)}aQ.find("div.colpick_submit").html(b.submitText).click(ej);b.fields=aQ.find("input").change(fL).blur(bU).focus(bi);aQ.find("div.colpick_field_arrs").mousedown(bF).end().find("div.colpick_current_color").click(d);b.selector=aQ.find("div.colpick_color").on("mousedown touchstart",g);b.selectorIndic=b.selector.find("div.colpick_selector_outer");b.el=this;b.hue=aQ.find("div.colpick_hue_arrs");huebar=b.hue.parent();var eV=navigator.userAgent.toLowerCase();var ed=navigator.appName==="Microsoft Internet Explorer";var aC=ed?parseFloat(eV.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0;var fA=ed&&aC<10;var fV=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(fA){var L,cS;for(L=0;L<=11;L++){cS=f("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+fV[L]+", endColorstr="+fV[L+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+fV[L]+", endColorstr="+fV[L+1]+')";');huebar.append(cS)}}else{stopList=fV.join(",");huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ")}aQ.find("div.colpick_hue").on("mousedown touchstart",eG);b.newColor=aQ.find("div.colpick_new_color");b.currentColor=aQ.find("div.colpick_current_color");aQ.data("colpick",b);A(b.color,aQ.get(0));h(b.color,aQ.get(0));c(b.color,aQ.get(0));cF(b.color,aQ.get(0));bZ(b.color,aQ.get(0));eh(b.color,aQ.get(0));fP(b.color,aQ.get(0));if(b.flat){aQ.appendTo(this).show();aQ.css({position:"relative",display:"block"})}else{aQ.appendTo(document.body);f(this).on(b.showEvent,cK);aQ.css({position:"absolute"})}}})},showPicker:function(){return this.each(function(){if(f(this).data("colpickId")){cK.apply(this)}})},hidePicker:function(){return this.each(function(){if(f(this).data("colpickId")){f("#"+f(this).data("colpickId")).hide()}})},setColor:function(W,b){b=typeof b==="undefined"?1:b;if(typeof W=="string"){W=a(W)}else if(W.r!=undefined&&W.g!=undefined&&W.b!=undefined){W=aQ(W)}else if(W.h!=undefined&&W.s!=undefined&&W.b!=undefined){W=H(W)}else{return this}return this.each(function(){if(f(this).data("colpickId")){var a=f("#"+f(this).data("colpickId"));a.data("colpick").color=W;a.data("colpick").origColor=W;A(W,a.get(0));h(W,a.get(0));c(W,a.get(0));cF(W,a.get(0));bZ(W,a.get(0));fP(W,a.get(0));a.data("colpick").onChange.apply(a.parent(),[W,eV(W),e(W),a.data("colpick").el,1]);if(b){eh(W,a.get(0))}}})}}}();var b=function(f){var f=parseInt(f.indexOf("#")>-1?f.substring(1):f,16);return{r:f>>16,g:(f&65280)>>8,b:f&255}};var a=function(f){return aQ(b(f))};var aQ=function(f){var W={h:0,s:0,b:0};var b=Math.min(f.r,f.g,f.b);var a=Math.max(f.r,f.g,f.b);var aQ=a-b;W.b=a;W.s=a!=0?255*aQ/a:0;if(W.s!=0){if(f.r==a)W.h=(f.g-f.b)/aQ;else if(f.g==a)W.h=2+(f.b-f.r)/aQ;else W.h=4+(f.r-f.g)/aQ}else W.h=-1;W.h*=60;if(W.h<0)W.h+=360;W.s*=100/255;W.b*=100/255;return W};var e=function(f){var W={};var b=f.h;var a=f.s*255/100;var aQ=f.b*255/100;if(a==0){W.r=W.g=W.b=aQ}else{var e=aQ;var A=(255-a)*aQ/255;var eV=(e-A)*(b%60)/60;if(b==360)b=0;if(b<60){W.r=e;W.b=A;W.g=A+eV}else if(b<120){W.g=e;W.b=A;W.r=e-eV}else if(b<180){W.g=e;W.r=A;W.b=A+eV}else if(b<240){W.b=e;W.r=A;W.g=e-eV}else if(b<300){W.b=e;W.g=A;W.r=A+eV}else if(b<360){W.r=e;W.g=A;W.b=e-eV}else{W.r=0;W.g=0;W.b=0}}return{r:Math.round(W.r),g:Math.round(W.g),b:Math.round(W.b)}};var A=function(W){var b=[W.r.toString(16),W.g.toString(16),W.b.toString(16)];f.each(b,function(f,W){if(W.length==1){b[f]="0"+W}});return b.join("")};var eV=function(f){return A(e(f))};f.fn.extend({colpick:W.init,colpickHide:W.hidePicker,colpickShow:W.showPicker,colpickSetColor:W.setColor});f.extend({colpick:{rgbToHex:A,rgbToHsb:aQ,hsbToHex:eV,hsbToRgb:e,hexToHsb:a,hexToRgb:b}})})(jQuery);